##### v2.2.1 (gulp+webpack)

# Среда разработки
* **node** ^6.x.x (для упрощения процесса перехода между версиями советую установить **[n](https://www.npmjs.com/package/n)**)
* **npm** ^3.x.x
* **gulp** ^3.x.x (требуется глобальная установка через npm install -g gulp@3)


# Шаги
* После клонирования проекта локально, переименовываем папку _rocket-frontend/_ в соответствии с названием нашего нового проекта
* Создаем свой проект в гитлабе Ракетной фирмы. http://gitlab.rocketfirm.net. Либо, если проект уже существует, заливает в него недостающий папки и файлы из этого репозитория
* После создания нового проета в Git, правим гитовские конфиги в локальной директории проекта на вашей машине, чтобы он смотрел на ваш новый репозиторий, а не на репозиторий шаблона (https://help.github.com/articles/changing-a-remote-s-url/). Либо просто удаляем папку .git и следуем инструкциям Git (при создании нового проекта, Git детально описывает, что вам нужно сделать)
* Из корня данного проекта запускаем команду `npm install && bower install`, чтобы установить нужные зависимости   


# Команды
## `gulp serve`
Сервирует проект с локалхоста, смотрит в папки _.tmp/_ и _frontend/_. Основной режим разработки.

## `gulp serve:web`
Сервирует собранный проект с локалхоста, смотрит в папку _web/_.

## `gulp`
Дефолтная команда для сборки проекта в режиме markup.

## `gulp build`
Собирает проект в папку _web/_ в режиме markup. Билдит html файлы, копирует папку _pics/_, не собирает админские скрипты и стили.

## `gulp build:prod`
Собирает проект в папку _web/_ в режиме production. Не билдит html файлы, не копирует папку _pics/_, собирает админские скрипты и стили. Использовать эту команду в деплоере.

## `gulp size`
Выдает общий gzip размер папки _web/_. Без учета папки _media/_.

## `gulp size:all`
Выдает общий gzip размер папки _web/_. C учетом папки _media/_.

## `gulp size:detailed`
Выдает gzip размеры папок _styles/_, _scripts/_, _images/_, _fonts/_ и размеры файлов, которые находятся внутри.   



# HTML шаблонизатор **[Nunjucks](https://mozilla.github.io/nunjucks/templating.html)** от Mozilla
Переходим на nunjucks:) Привыкаем к синтаксису а ля `{% include "_partials/header" %}`, `{% block content %}{% endblock %}`, `{% extends "_partials/variables.njk" %}`. Как обычно, стараемся все повторяющиеся блоки, такие как хэдер, футер, пагинацию, делать паршиалами, и добавлять их в нашу разметку как по мере необходимости. Эти компоненты создаем в папке _partials. Подробнее о синтаксисе и возможностях nunjucks читаем в документации. Темплейты самих сттаниц создаем в папке `layouts/`.

#### Подсветка синтаксиса в Sublime Text для nunjucks - **Jinja2 (HTML)**   



# Подключение jQuery
Так как на бою Yii сам подключает свой jQuery, при сборке в режиме production jquery уже не нужен. Для этого в папке /views/layouts/ лежит два темплейта, которые отличаются только наличием/отсутствием строки ```<script src="bower_components/jquery/dist/jquery.min.js"></script>```. Какой именно шаблон использовать определяем внутри `views/_partials/variables.njk`. Этот паршиал экспортирует переменную на все страницы, через нее мы и пределяем какой шаблон использовать при сборке. Дефолтный темплейт - `markup.njk`.


# Плагины
Все библитеки устанавливаем через bower. Подключаем в следующих точках:
1. в файлах папки layouts/, внутри <!-- bower -->...<!-- endbower -->
2. админские скрипты и стили подключаем в gulpfile.js внутри задач `styles-admin-plugins` и `scripts-admin-plugins`


# Админские файлы

### Стили
* Как и раньше, кастомные стили кладем в папку styles/admin/
* Админские стили подключаем в gulpfile.js внутри задачи `styles-admin-plugins`

### Скрипты
* Кастомные скрипты, как обычно, складываем в папку scripts/admin/
* Админские скрипты подключаем в gulpfile.js внутри задачи `scripts-admin-plugins`


# Линтеры
Для проверки синтаксиса используются [stylelint](http://stylelint.io/user-guide/rules/) и [eslint](http://eslint.org/docs/rules/). Они запускаются каждый раз, когда мы делаем изменение в .css и в .js файлах. Конфиги линтеров находятся в файлах .stylelintrc и .eslinrc.


## [Трекер багов](http://gitlab.rocketfirm.net/rocketfirm/rocket-frontend/issues)
